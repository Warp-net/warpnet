project_name: warpnet
version: 2

builds:
  # Linux
  - id: member-linux
    main: ./cmd/node/member/
    binary: member
    env: [ CGO_ENABLED=1 ]
    goos: [linux]
    goarch: [amd64]
    flags:
      - -mod=vendor
      - -tags=webkit2_41
    ldflags:
      - -s -w
    hooks:
      pre: |
        go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2
        wails build -tags webkit2_41 -platform linux/amd64 -clean

  # macOS
  - id: member-macos
    main: ./cmd/node/member/
    binary: member
    env: [ CGO_ENABLED=1 ]
    goos: [darwin]
    goarch: [amd64, arm64]
    flags:
      - -mod=vendor
    ldflags:
      - -s -w
    hooks:
      pre: |
        go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2
        wails build -platform darwin/{{ .Arch }} -clean

  # Windows
  - id: member-windows
    main: ./cmd/node/member/
    binary: member
    env: [ CGO_ENABLED=1 ]
    goos: [windows]
    goarch: [amd64]
    flags:
      - -mod=vendor
    ldflags:
      - -s -w
    hooks:
      pre: |
        go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2
        wails build -platform windows/amd64 -clean


#nfpms:
#  - maintainer: Vadim Filin <github.com.mecdy@passmail.net>
#    description: P2P social network.
#    homepage: https://github.com/Warp-net/warpnet
#    license: ''
#    formats:
#      - deb
#      - rpm

release:
  github:
    owner: Warp-net
    name: warpnet

