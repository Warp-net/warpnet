project_name: warpnet
version: 2

builds:
  - id: member-linux
    main: ./cmd/node/member/
    binary: member
    env:
      - CGO_ENABLED=1
    goos: [ linux ]
    goarch: [ amd64 ]
    flags:
      - -mod=vendor
    hooks:
#      pre: |
#        sh -c 'sudo apt update &&
#          sudo apt install -y \
#            libgtk-3-dev libwebkit2gtk-4.0-dev libwebkit2gtk-4.1-dev libglib2.0-dev pkg-config \
#            libnss3 libx11-xcb-dev libxcomposite-dev libxdamage-dev libxrandr-dev \
#            libasound2-dev libatk1.0-dev libcups2-dev libdbus-1-dev libdrm-dev \
#            libxext-dev libxfixes-dev libxkbcommon-dev libxrender-dev libxcb1-dev libxtst-dev &&
#          echo "$HOME/go/bin" >> $GITHUB_PATH &&
#          go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2 &&
#          cd cmd/node/member &&
#          wails build -tags webkit2_41 -platform linux/amd64 -clean'

      pre: |
        sudo apt update &&
        sudo apt install -y libwebkit2gtk-4.1-dev &&
        go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2 &&
        cd cmd/node/member && wails build -tags webkit2_41 -platform linux/amd64 -clean

#  - id: member-macos-amd64
#    main: ./cmd/node/member/
#    binary: member
#    env:
#      - CGO_ENABLED=1
#      - CGO_CFLAGS=
#      - CGO_LDFLAGS=
#    goos: [ darwin ]
#    goarch: [ amd64 ]
#    flags:
#      - -mod=vendor
#    hooks:
#      pre: |
#        sh -c 'go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2 &&
#          cd cmd/node/member &&
#          wails build -platform darwin/amd64 -clean'

#  - id: member-macos-arm64
#    main: ./cmd/node/member/
#    binary: member
#    env:
#      - CGO_ENABLED=1
#      - CC=clang
#      - CXX=clang++
#      - CGO_CFLAGS=--target=arm64-apple-macos11
#      - CGO_LDFLAGS=--target=arm64-apple-macos11
#    goos: [ darwin ]
#    goarch: [ arm64 ]
#    flags:
#      - -mod=vendor
#    ldflags:
#      - -s -w
#    hooks:
#      pre: |
#        sh -c '
#          export SDKROOT=$(xcrun --sdk macosx --show-sdk-path) &&
#          export CGO_CFLAGS="--target=arm64-apple-macos11 -isysroot $SDKROOT" &&
#          export CGO_LDFLAGS="--target=arm64-apple-macos11 -isysroot $SDKROOT" &&
#          export GOARCH=arm64 &&
#          go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2 &&
#          cd cmd/node/member &&
#          wails build -platform darwin/arm64 -clean'

#  - id: member-windows
#    main: ./cmd/node/member/
#    binary: member
#    env:
#      - CGO_ENABLED=1
#      - CGO_CFLAGS=
#      - CGO_LDFLAGS=
#    goos: [ windows ]
#    goarch: [ amd64 ]
#    flags:
#      - -mod=vendor
#    hooks:
#      pre: |
#        sh -c 'go install github.com/wailsapp/wails/v2/cmd/wails@v2.10.2 &&
#          cd cmd/node/member &&
#          wails build -platform windows/amd64 -clean'

release:
  github:
    owner: Warp-net
    name: warpnet

